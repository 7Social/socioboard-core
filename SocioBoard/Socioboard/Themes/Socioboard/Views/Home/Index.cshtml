@{
    //ViewBag.Title = "Home Page";
}


<div id="page-wrapper">
    <div id="DisplayCount" class="row" data-url="/Home/DisplayCount">
        @*@Html.Partial("_HomeUserActivityPartial")*@
        @*@Html.Action("DisplayCount","Home")*@
    </div>
    <div class="container-fluid">
        <div class="col-md-12">
            <div class="col-md-9 partialContents" data-url="/Home/ProfileSnapshot">
                <img src="~/Themes/@System.Configuration.ConfigurationManager.AppSettings["domain"]/Contents/img/loader.gif" />
                Loading . . .
   
            </div>
            <div class="col-md-3 partialContents" data-url="/Home/UserProfile">
                <img src="~/Themes/@System.Configuration.ConfigurationManager.AppSettings["domain"]/Contents/img/loader.gif" />
                Loading . . .
  

            </div>
        </div>
    </div>
</div>


<script type="text/javascript">

    function getParameterByName(name) {
        var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
        return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
    }

    function AddfbPage(fbpagename, fbpageid, fbpagetoken, email)
    {
       
        $.ajax({
            type: 'POST',
            url: '../FacebookManager/AddFbPage?profileid=' + fbpageid + '&accesstoken=' + fbpagetoken+'&email='+email,
            contentType: false,
            success: function (data) {
                alertify.set({ delay: 3000 });
                $('#facebookpageinfo').css({ 'display': 'none' });
                $('#facebookpopup').modal('hide');
                alertify.success("Fan Page Added Successfully");
                window.location = '../Home/Index';
            }
        });
        
    }

    function AddfbGroup(fbgroupname, fbgroupid, fbtoken, email) {
        debugger;
      
        $.ajax({
            type: 'POST',
            url: '../FacebookManager/AddFbGroup?ProfileGroupId=' + fbgroupid + '&accesstoken=' + fbtoken + '&email=' + email + '&Name=' + fbgroupname,
            contentType: false,
            success: function (data) {
            
                alertify.set({ delay: 3000 });
                $('#facebookpageinfo').css({ 'display': 'none' });
                $('#facebookpopup').modal('hide');
                alertify.success("Group Added Successfully");
                window.location = '../Home/Index';
            }
        });

    }

    $(document).ready(function (e) {
        var hint =getParameterByName("hint");
        if (hint != "" || hint != null)
        {
            if (hint == "fbpage")
            {
                $.ajax({
                    type: 'POST',
                    url: '../FacebookManager/GetFBPage',
                    success: function (msg) {
                     
                        var fbpagearr = msg.split('~');
                        for (var i = 0; i < fbpagearr.length; i++) {
                            var fbpageinfoarr = fbpagearr[i].split('`');
                            try {
                                $('#fbpagebind').append('<a style="cursor: pointer;margin-left:21px" onclick="AddfbPage(\'' + fbpageinfoarr[0] + '\',\'' + fbpageinfoarr[1] + '\',\'' + fbpageinfoarr[2]+ '\',\'' + fbpageinfoarr[3] + '\')">' + fbpageinfoarr[0] + '</a><br />');
                            } catch (e) {

                            }
                        }                       
                        $('#facebookpageinfo').css({ 'display': 'block' });
                        $('#facebookpopup').modal('show');
                    },
                    async: false
                });

            }

            else if (hint == "fbgrp") {
                $.ajax({
                    type: 'POST',
                    url: '../FacebookManager/GetFBGroup',
                    success: function (msg) {
                        
                        var fbgrouparr = msg.split('~');
                        for (var i = 0; i < fbgrouparr.length; i++) {
                            var fbgroupinfoarr = fbgrouparr[i].split('`');
                            try {
                                $('#fbpagebind').append('<a style="cursor: pointer;margin-left:21px" onclick="AddfbGroup(\'' + fbgroupinfoarr[0] + '\',\'' + fbgroupinfoarr[1] + '\',\'' + fbgroupinfoarr[2] + '\',\'' + fbgroupinfoarr[3] + '\')">' + fbgroupinfoarr[0] + '</a><br />');
                            } catch (e) {

                            }
                        }
                        $('#facebookpageinfo').css({ 'display': 'block' });
                        $('#facebookpopup').modal('show');
                    },
                    async: false
                });
            }
        }
       
        $('#message').find('ul').remove();
        $('#feeds').find('ul').remove();
        $('#publishing').find('ul').remove();
        $('#reports').find('ul').remove();
        $('#group').find('ul').remove();

        // alert('asdasda');
        $(".partialContents").each(function (index, item) {
            var url = $(item).data("url");
            if (url && url.length > 0) {
                $(item).load(url);
            }
        });

        try {
            debugger;
            $("#DisplayCount").load($("#DisplayCount").data("url"));
        } catch (e) {
            alert(e);
        }

       // $('#groupsselection').change(function () {
       //    // alert($("#groupsselection option:selected").text());
       //     //alert($("#groupsselection").val());
       //     var groupid = $("#groupsselection").val();
       //     $.ajax
       //({
       //    type: "POST",
       //    url: "../Home/ChangeGroup?groupid=" + groupid,
       //    data: '',
       //    contentType: "application/json; charset=utf-8",
       //    dataType: "html",
       //    success: function (msg) {
       //        window.location = self.location;
       //    }
       //});
       // });

    });


</script>












